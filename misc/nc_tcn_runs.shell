
Tip of the Day:	Keine Antwort ist das halbe Leben.


(base) lo63tor@zwoa:~/master/dna_class/preprocessing$ conda activate dna_class_gpu
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class/preprocessing$ cd ..
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ python utils/test_model.py
usage: test_model.py [-h] [--verbose] [--no_tensorboard] [--emb_layer_dim int [int ...]]
                     [--dropout_rate float [float ...]] [--max_pool str2bool [str2bool ...]]
                     [--nr_filters int [int ...]] [--kernel_size int [int ...]] [--nr_layers int [int ...]]
                     [--neurons_full int [int ...]] [--conv_strides int [int ...]] [--lstm_units int [int ...]]
                     [--cell_type {lstm,gru} [{lstm,gru} ...]] [--bidirectional str2bool [str2bool ...]]
                     [--last_dilation_2exp int [int ...]]
                     [--data_source {genes,fragments} [{genes,fragments} ...]] [--classes str [str ...]]
                     [--nr_seqs int [int ...]] [--batch_size int [int ...]]
                     [--fixed_size_method {pad,window,repeat} [{pad,window,repeat} ...]] [--rev_comp]
                     [--rev_comp_mode {append,random,independent} [{append,random,independent} ...]]
                     [--enc_dimension int [int ...]] [--enc_k int [int ...]] [--enc_stride int [int ...]]
                     [--cache_batches str2bool [str2bool ...]] [--cache_seq_limit int [int ...]]
                     [--root_fa_dir str [str ...]] [--root_fragments_dir str [str ...]]
                     [--file_names_cache str [str ...]]
                     [--enc_method {words2index,words2onehot,words2vec} [{words2index,words2onehot,words2vec} ...]]
                     [--w2vfile str [str ...]] [--bert_token_dict_json str [str ...]]
                     [--bert_pretrained_path str [str ...]] [--max_seq_len int [int ...]] [--epochs int [int ...]]
                     [--learning_rate float [float ...]] [--test_split float [float ...]]
                     [--model_name str [str ...]] [--class_report str2bool [str2bool ...]]
                     [--early_stopping str2bool [str2bool ...]] [--early_stopping_md float [float ...]]
                     [--early_stopping_p int [int ...]] [--early_stopping_restore_weights str2bool [str2bool ...]]
                     [--model_checkpoints] [--model_checkpoints_keep_all] [--summary] [--plot] [--save]
                     {cnn,cnndeep_predef,lstm,tcn,ff,bert}
test_model.py: error: the following arguments are required: type
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn --nr_seqs 1000 --batch_size 70 --summary --epochs 5 
Traceback (most recent call last):
  File "utils/test_model.py", line 12, in <module>
    import models.model as model
  File "/home/lo63tor/master/dna_class/models/model.py", line 3, in <module>
    from preprocessing.generate_data import DataSplit
  File "/home/lo63tor/master/dna_class/preprocessing/generate_data.py", line 297, in <module>
    class FragmentGenerator(Sequence):
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/dataclasses.py", line 991, in dataclass
    return wrap(_cls)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/dataclasses.py", line 983, in wrap
    return _process_class(cls, init, repr, eq, order, unsafe_hash, frozen)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/dataclasses.py", line 834, in _process_class
    for name, type in cls_annotations.items()]
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/dataclasses.py", line 834, in <listcomp>
    for name, type in cls_annotations.items()]
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/dataclasses.py", line 727, in _get_field
    raise ValueError(f'mutable default {type(f.default)} for field '
ValueError: mutable default <class 'list'> for field classes is not allowed: use default_factory
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn --nr_seqs 1000 --batch_size 70 --summary --epochs 5 
Traceback (most recent call last):
  File "utils/test_model.py", line 12, in <module>
    import models.model as model
  File "/home/lo63tor/master/dna_class/models/model.py", line 3, in <module>
    from preprocessing.generate_data import DataSplit
  File "/home/lo63tor/master/dna_class/preprocessing/generate_data.py", line 297, in <module>
    class FragmentGenerator(Sequence):
  File "/home/lo63tor/master/dna_class/preprocessing/generate_data.py", line 304, in FragmentGenerator
    classes: List = field(default_factory=lambda:
NameError: name 'List' is not defined
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn --nr_seqs 1000 --batch_size 70 --summary --epochs 5 
Traceback (most recent call last):
  File "utils/test_model.py", line 152, in <module>
    x, y = load_fragments(args.root_fragments_dir, nr_seqs=args.nr_seqs)
  File "/home/lo63tor/master/dna_class/preprocessing/generate_data.py", line 333, in load_fragments
    for class_ in classes:
NameError: name 'classes' is not defined
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn --nr_seqs 1000 --batch_size 70 --summary --epochs 5 
configuration 1/1	 model name: nc_tcn_658449957, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 4, 'nb_filters': 16, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 12:20:56.191635: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 12:20:56.300995: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 12:20:56.301890: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5637ddcf77e0 executing computations on platform Host. Devices:
2020-04-06 12:20:56.301929: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 12:20:56.303039: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 16)                20928     
_________________________________________________________________
classification (Dense)       (None, 4)                 68        
=================================================================
Total params: 21,061
Trainable params: 21,061
Non-trainable params: 0
_________________________________________________________________
Traceback (most recent call last):
  File "utils/test_model.py", line 231, in <module>
    tensorboard=(not args.no_tensorboard), callbacks=callbacks)
  File "/home/lo63tor/master/dna_class/models/model.py", line 353, in train
    epochs=epochs, callbacks=callbacks)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 728, in fit
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 224, in fit
    distribution_strategy=strategy)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 547, in _process_training_inputs
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 606, in _process_inputs
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/data_adapter.py", line 605, in __init__
    peek = x[0]
  File "/home/lo63tor/master/dna_class/preprocessing/generate_data.py", line 320, in __getitem__
    (idx+1) * selfbatch_size]
NameError: name 'selfbatch_size' is not defined
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn --nr_seqs 1000 --batch_size 70 --summary --epochs 5 
configuration 1/1	 model name: nc_tcn_658449957, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 4, 'nb_filters': 16, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 12:22:43.454323: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 12:22:43.524813: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 12:22:43.525632: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5641c4f93280 executing computations on platform Host. Devices:
2020-04-06 12:22:43.525664: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 12:22:43.539049: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 16)                20928     
_________________________________________________________________
classification (Dense)       (None, 4)                 68        
=================================================================
Total params: 21,061
Trainable params: 21,061
Non-trainable params: 0
_________________________________________________________________
Traceback (most recent call last):
  File "utils/test_model.py", line 231, in <module>
    tensorboard=(not args.no_tensorboard), callbacks=callbacks)
  File "/home/lo63tor/master/dna_class/models/model.py", line 353, in train
    epochs=epochs, callbacks=callbacks)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 728, in fit
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 224, in fit
    distribution_strategy=strategy)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 547, in _process_training_inputs
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 606, in _process_inputs
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/data_adapter.py", line 615, in __init__
    dataset = dataset.shuffle(len(x))
  File "/home/lo63tor/master/dna_class/preprocessing/generate_data.py", line 314, in __len__
    float(batch_size)).astype(np.int)
NameError: name 'batch_size' is not defined
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn --nr_seqs 1000 --batch_size 70 --summary --epochs 5 
configuration 1/1	 model name: nc_tcn_658449957, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 4, 'nb_filters': 16, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 12:23:23.951187: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 12:23:23.964759: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 12:23:23.965527: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cef5d03a20 executing computations on platform Host. Devices:
2020-04-06 12:23:23.965562: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 12:23:23.967247: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 16)                20928     
_________________________________________________________________
classification (Dense)       (None, 4)                 68        
=================================================================
Total params: 21,061
Trainable params: 21,061
Non-trainable params: 0
_________________________________________________________________
Train for 44 steps, validate for 3 steps
Epoch 1/5
44/44 [==============================] - 31s 704ms/step - loss: 1.4679 - accuracy: 0.2276 - val_loss: 1.3947 - val_accuracy: 0.2375
Epoch 2/5
44/44 [==============================] - 27s 604ms/step - loss: 1.3838 - accuracy: 0.2520 - val_loss: 1.3670 - val_accuracy: 0.2750
Epoch 3/5
44/44 [==============================] - 26s 582ms/step - loss: 1.3523 - accuracy: 0.3135 - val_loss: 1.2908 - val_accuracy: 0.3562
Epoch 4/5
44/44 [==============================] - 23s 516ms/step - loss: 1.3086 - accuracy: 0.3553 - val_loss: 1.2671 - val_accuracy: 0.3562
Epoch 5/5
44/44 [==============================] - 25s 577ms/step - loss: 1.2903 - accuracy: 0.3750 - val_loss: 1.3437 - val_accuracy: 0.2688
test loss / test accuracy = 1.3434 / 0.2850
              precision    recall  f1-score   support

     Viruses       0.23      0.72      0.35       177
     Archaea       0.32      0.16      0.21       210
    Bacteria       0.78      0.04      0.07       196
   Eukaryota       0.29      0.19      0.23       217

    accuracy                           0.26       800
   macro avg       0.41      0.28      0.22       800
weighted avg       0.41      0.26      0.21       800

(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py --help
usage: test_model.py [-h] [--verbose] [--no_tensorboard] [--emb_layer_dim int [int ...]]
                     [--dropout_rate float [float ...]] [--max_pool str2bool [str2bool ...]]
                     [--nr_filters int [int ...]] [--kernel_size int [int ...]] [--nr_layers int [int ...]]
                     [--neurons_full int [int ...]] [--conv_strides int [int ...]] [--lstm_units int [int ...]]
                     [--cell_type {lstm,gru} [{lstm,gru} ...]] [--bidirectional str2bool [str2bool ...]]
                     [--last_dilation_2exp int [int ...]]
                     [--data_source {genes,fragments} [{genes,fragments} ...]] [--classes str [str ...]]
                     [--nr_seqs int [int ...]] [--batch_size int [int ...]]
                     [--fixed_size_method {pad,window,repeat} [{pad,window,repeat} ...]] [--rev_comp]
                     [--rev_comp_mode {append,random,independent} [{append,random,independent} ...]]
                     [--enc_dimension int [int ...]] [--enc_k int [int ...]] [--enc_stride int [int ...]]
                     [--cache_batches str2bool [str2bool ...]] [--cache_seq_limit int [int ...]]
                     [--root_fa_dir str [str ...]] [--root_fragments_dir str [str ...]]
                     [--file_names_cache str [str ...]]
                     [--enc_method {words2index,words2onehot,words2vec} [{words2index,words2onehot,words2vec} ...]]
                     [--w2vfile str [str ...]] [--bert_token_dict_json str [str ...]]
                     [--bert_pretrained_path str [str ...]] [--max_seq_len int [int ...]] [--epochs int [int ...]]
                     [--learning_rate float [float ...]] [--test_split float [float ...]]
                     [--model_name str [str ...]] [--class_report str2bool [str2bool ...]]
                     [--early_stopping str2bool [str2bool ...]] [--early_stopping_md float [float ...]]
                     [--early_stopping_p int [int ...]] [--early_stopping_restore_weights str2bool [str2bool ...]]
                     [--model_checkpoints] [--model_checkpoints_keep_all] [--summary] [--plot] [--save]
                     {cnn,cnndeep_predef,lstm,tcn,ff,bert}

runs models

positional arguments:
  {cnn,cnndeep_predef,lstm,tcn,ff,bert}
                        (implemented) type of model to run

optional arguments:
  -h, --help            show this help message and exit
  --verbose, -v
  --no_tensorboard

nns:
  --emb_layer_dim int [int ...]
                        [Default: 1]
  --dropout_rate float [float ...]
                        [Default: 0.01]
  --max_pool str2bool [str2bool ...]
                        [Default: True]
  --nr_filters int [int ...]
                        [Default: 16]
  --kernel_size int [int ...]
                        [Default: 4]
  --nr_layers int [int ...]
                        [Default: 16]
  --neurons_full int [int ...]
                        [Default: 64]
  --conv_strides int [int ...]
                        [Default: 1]
  --lstm_units int [int ...]
                        [Default: 32]
  --cell_type {lstm,gru} [{lstm,gru} ...]
                        [Default: lstm]
  --bidirectional str2bool [str2bool ...]
                        [Default: True]
  --last_dilation_2exp int [int ...]
                        base-2 exponent of last dilation; eg.: 3: dilations=[1,2,4,8] [Default: 9]

data:
  --data_source {genes,fragments} [{genes,fragments} ...]
                        dataset type to use [Default: genes]
  --classes str [str ...]
                        [Default: ['Viruses', 'Archaea', 'Bacteria', 'Eukaryota']]
  --nr_seqs int [int ...]
                        [Default: 10000]
  --batch_size int [int ...]
                        [Default: 500]
  --fixed_size_method {pad,window,repeat} [{pad,window,repeat} ...]
                        Method for transforming sequences to fixed length [Default: pad]
  --rev_comp            [Default: False]
  --rev_comp_mode {append,random,independent} [{append,random,independent} ...]
                        [Default: append]
  --enc_dimension int [int ...]
                        [Default: 65]
  --enc_k int [int ...]
                        [Default: 3]
  --enc_stride int [int ...]
                        [Default: 3]
  --cache_batches str2bool [str2bool ...]
                        [Default: True]
  --cache_seq_limit int [int ...]
                        [Default: None]
  --root_fa_dir str [str ...]
                        [Default: /home/lo63tor/master/sequences/dna_sequences/]
  --root_fragments_dir str [str ...]
                        [Default: /home/lo63tor/master/dna_class/output/genomic_fragments]
  --file_names_cache str [str ...]
                        [Default: /home/lo63tor/master/sequences/dna_sequences/files.json]
  --enc_method {words2index,words2onehot,words2vec} [{words2index,words2onehot,words2vec} ...]
                        [Default: words2index]
  --w2vfile str [str ...]
                        filename of a pickled word vector dict [Default: None]
  --bert_token_dict_json str [str ...]
                        path to the JSON-serialized keras-bert token dict [Default: ]
  --bert_pretrained_path str [str ...]
                        path to pre-trained keras-bert model [Default: ]
  --max_seq_len int [int ...]
                        Length of *all* sequences when using any `fixed_size_method` [Default: 10000]

run:
  --epochs int [int ...]
                        [Default: 100]
  --learning_rate float [float ...]
                        [Default: 0.003]
  --test_split float [float ...]
                        [Default: 0.2]
  --model_name str [str ...]
                        [Default: 12-27]
  --class_report str2bool [str2bool ...]
                        prints metrics by class for evalutation [Default: True]
  --early_stopping str2bool [str2bool ...]
                        [Default: True]
  --early_stopping_md float [float ...]
                        min_delta [Default: 0.01]
  --early_stopping_p int [int ...]
                        patience [Default: 5]
  --early_stopping_restore_weights str2bool [str2bool ...]
                        restore best weights [Default: True]
  --model_checkpoints   saves model after every epoch [Default: False]
  --model_checkpoints_keep_all
                        checkpoints won't be overridden [Default: False]
  --summary             [Default: False]
  --plot                [Default: False]
  --save                save model to `model_name`.h5 [Default: False]
na_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn --nr_seqs 10_000 --batch_size 250 --summary --epochs 5 --nr_filters 72 --kernel_size 6
configuration 1/1	 model name: nc_tcn_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 12:28:58.524758: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 12:28:58.540642: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 12:28:58.541597: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dddaae6450 executing computations on platform Host. Devices:
2020-04-06 12:28:58.541636: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 12:28:58.555022: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 603,717
Trainable params: 603,717
Non-trainable params: 0
_________________________________________________________________
2020-04-06 12:29:10.349981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 122
2020-04-06 12:29:20.516155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 69 of 122
2020-04-06 12:29:30.370288: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 105 of 122
2020-04-06 12:29:34.863577: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 122 steps, validate for 7 steps
Epoch 1/5
2020-04-06 12:29:51.430020: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 122
2020-04-06 12:30:01.227234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 72 of 122
2020-04-06 12:30:11.315635: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 107 of 122
2020-04-06 12:30:15.312701: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
122/122 [==============================] - 663s 5s/step - loss: 1.3751 - accuracy: 0.3297 - val_loss: 1.2164 - val_accuracy: 0.4031
Epoch 2/5
2020-04-06 12:40:49.274602: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 122
2020-04-06 12:40:59.292671: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 69 of 122
2020-04-06 12:41:09.256882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 104 of 122
2020-04-06 12:41:14.633364: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
  8/122 [>.............................] - ETA: 18:02 - loss: 1.2373 - accuracy: 0.3811WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
2020-04-06 12:41:55,005 - [WARNING] Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
Traceback (most recent call last):
  File "utils/test_model.py", line 231, in <module>
    tensorboard=(not args.no_tensorboard), callbacks=callbacks)
  File "/home/lo63tor/master/dna_class/models/model.py", line 353, in train
    epochs=epochs, callbacks=callbacks)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 728, in fit
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 324, in fit
    total_epochs=epochs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 123, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py", line 86, in execution_function
    distributed_function(input_fn))
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 457, in __call__
    result = self._call(*args, **kwds)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 487, in _call
    return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1823, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1141, in _filtered_call
    self.captured_inputs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1224, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 511, in call
    ctx=ctx)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py", line 61, in quick_execute
    num_outputs)
KeyboardInterrupt
2020-04-06 12:41:55.248481: W tensorflow/core/kernels/data/generator_dataset_op.cc:102] Error occurred when finalizing GeneratorDataset iterator: Failed precondition: Python interpreter state is not initialized. The process may be terminated.
	 [[{{node PyFunc}}]]

(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn_kgrid --nr_seqs 10_000 --batch_size 768 --summary --epochs 5 --nr_filters 72 --kernel_size 6 --enc_stride 1 --enc_k 3 4 5 6 7 8
  C-c C-cTraceback (most recent call last):
  File "utils/test_model.py", line 4, in <module>
    import tensorflow as tf
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow/__init__.py", line 98, in <module>
    from tensorflow_core import *
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/__init__.py", line 40, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 959, in _find_and_load_unlocked
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow/__init__.py", line 50, in __getattr__
    module = self._load()
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow/__init__.py", line 44, in _load
    module = _importlib.import_module(self.__name__)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/__init__.py", line 73, in <module>
    from tensorflow.python.ops.standard_ops import *
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/ops/standard_ops.py", line 25, in <module>
    from tensorflow.python import autograph
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/autograph/__init__.py", line 35, in <module>
    from tensorflow.python.autograph import operators
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/autograph/__init__.py", line 35, in <module>
    from tensorflow.python.autograph import operators
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/autograph/operators/__init__.py", line 40, in <module>
    from tensorflow.python.autograph.operators.control_flow import for_stmt
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/autograph/operators/control_flow.py", line 65, in <module>
    from tensorflow.python.autograph.operators import py_builtins
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/autograph/operators/py_builtins.py", line 30, in <module>
    from tensorflow.python.data.ops import dataset_ops
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/data/__init__.py", line 25, in <module>
    from tensorflow.python.data import experimental
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/data/experimental/__init__.py", line 89, in <module>
    from tensorflow.python.data.experimental.ops.batching import dense_to_sparse_batch
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/data/experimental/ops/batching.py", line 20, in <module>
    from tensorflow.python.data.ops import dataset_ops
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/data/ops/dataset_ops.py", line 46, in <module>
    from tensorflow.python.eager import function as eager_function
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 55, in <module>
    from tensorflow.python.ops import gradients_util
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 724, in exec_module
  File "<frozen importlib._bootstrap_external>", line 818, in get_code
  File "<frozen importlib._bootstrap_external>", line 917, in get_data
KeyboardInterrupt

(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn_kgrid --nr_seqs 10_000 --batch_size 768 --summary --epochs 5 --nr_filters 72 --kernel_size 6 --enc_stride 1 --enc_k 3 4 5 6 7 8 --cache_batches False
Traceback (most recent call last):
  File "utils/test_model.py", line 113, in <module>
    if (args.enc_stride > args.enc_k):
TypeError: '>' not supported between instances of 'int' and 'list'
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ for k in 3 4 5 6 7 8; do echo k = $k; nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn_grid_k_"$k" --nr_seqs 10_000 --batch_size 768 --summary --epochs 5 --nr_filters 72 --kernel_size 6 --enc_stride 1 --enc_k $k --cache_batches False; done
k = 3
configuration 1/1	 model name: nc_tcn_grid_k_3_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 12:46:35.030649: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 12:46:35.054597: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 12:46:35.055061: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561d595805f0 executing computations on platform Host. Devices:
2020-04-06 12:46:35.055080: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 12:46:35.063426: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 603,717
Trainable params: 603,717
Non-trainable params: 0
_________________________________________________________________
2020-04-06 12:46:51.280917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 12:46:59.457029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 12:47:09.342237: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 12:47:19.193082: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 12:47:29.071990: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 12:47:41.380693: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 12:47:51.256522: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 12:48:01.335630: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 12:48:11.333095: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 12:48:17.735292: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 12:48:39.196084: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 12:48:49.130441: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 12:48:59.110339: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 12:49:09.060988: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 12:49:18.974522: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 12:49:28.878805: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 12:49:38.810959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 12:49:51.161848: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 12:50:00.991440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 12:50:07.375512: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 673s 17s/step - loss: 1.4843 - accuracy: 0.2679 - val_loss: 1.3643 - val_accuracy: 0.2950
Epoch 2/5
2020-04-06 12:59:47.220304: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 12:59:57.291837: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 13:00:07.592846: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 13:00:17.689089: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 13:00:27.648679: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 13:00:37.675943: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 13:00:47.595006: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 13:00:57.525783: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 13:01:07.446080: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 13:01:16.339259: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 662s 17s/step - loss: 1.3022 - accuracy: 0.3828 - val_loss: 1.1660 - val_accuracy: 0.4538
Epoch 3/5
2020-04-06 13:10:49.108672: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 13:11:01.506364: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 13:11:09.105433: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 13:11:19.182489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 13:11:29.333365: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 13:11:39.240784: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 13:11:49.179124: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 13:11:59.143363: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 13:12:09.246682: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 13:12:18.104967: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 668s 17s/step - loss: 1.2859 - accuracy: 0.3940 - val_loss: 1.2462 - val_accuracy: 0.4394
Epoch 4/5
2020-04-06 13:21:57.289139: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 13:22:07.259921: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 13:22:17.427451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 13:22:27.365502: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 13:22:37.329215: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 13:22:47.291887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 13:22:57.290809: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 13:23:07.363177: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 13:23:17.729890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 13:23:26.700762: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 663s 17s/step - loss: 1.2112 - accuracy: 0.4394 - val_loss: 1.1417 - val_accuracy: 0.4775
Epoch 5/5
2020-04-06 13:32:59.430784: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 13:33:10.187046: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 13:33:20.975187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 13:33:31.686890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 13:33:39.848182: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 19 of 40
2020-04-06 13:33:50.286981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 13:34:00.400982: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 13:34:10.381421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 13:34:20.368935: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 13:34:30.347851: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 13:34:31.811981: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 669s 17s/step - loss: 1.1851 - accuracy: 0.4625 - val_loss: 1.1457 - val_accuracy: 0.4675
test loss / test accuracy = 1.1697 / 0.4708
              precision    recall  f1-score   support

     Viruses       0.54      0.20      0.29      2016
     Archaea       0.39      0.34      0.37      1984
    Bacteria       0.47      0.78      0.59      2008
   Eukaryota       0.47      0.52      0.49      1992

    accuracy                           0.46      8000
   macro avg       0.47      0.46      0.43      8000
weighted avg       0.47      0.46      0.43      8000

k = 4
configuration 1/1	 model name: nc_tcn_grid_k_4_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 13:47:11.887487: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 13:47:11.905132: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 13:47:11.905735: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f690a5e4a0 executing computations on platform Host. Devices:
2020-04-06 13:47:11.905752: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 13:47:11.911143: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 603,717
Trainable params: 603,717
Non-trainable params: 0
_________________________________________________________________
2020-04-06 13:47:29.347793: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 13:47:38.875537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 13:47:48.828241: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 13:47:58.580527: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 13:48:07.912805: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 13:48:16.891185: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 19 of 40
2020-04-06 13:48:28.981435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 13:48:37.984841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 13:48:47.007549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 13:48:59.014059: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 13:49:08.250963: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 13:49:17.266616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 13:49:19.014821: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 13:49:42.752814: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 13:49:51.774393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 13:50:00.782911: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 13:50:13.244317: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 13:50:22.234314: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 13:50:31.204970: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 13:50:43.240048: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 13:50:52.311758: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 13:51:01.351489: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 13:51:13.618603: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 13:51:22.855828: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 13:51:30.615405: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
2020-04-06 13:51:30.619078: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Invalid argument: indices[192,0] = 192 is not in [0, 65)
	 [[{{node model/embedding/embedding_lookup}}]]
 1/40 [..............................] - ETA: 1:23:14WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
2020-04-06 13:51:33,277 - [WARNING] Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
Traceback (most recent call last):
  File "utils/test_model.py", line 231, in <module>
    tensorboard=(not args.no_tensorboard), callbacks=callbacks)
  File "/home/lo63tor/master/dna_class/models/model.py", line 353, in train
    epochs=epochs, callbacks=callbacks)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 728, in fit
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 324, in fit
    total_epochs=epochs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 123, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py", line 86, in execution_function
    distributed_function(input_fn))
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 457, in __call__
    result = self._call(*args, **kwds)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 520, in _call
    return self._stateless_fn(*args, **kwds)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1823, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1141, in _filtered_call
    self.captured_inputs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1224, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 511, in call
    ctx=ctx)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py", line 67, in quick_execute
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError:  indices[192,0] = 192 is not in [0, 65)
	 [[node model/embedding/embedding_lookup (defined at /home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:1751) ]] [Op:__inference_distributed_function_7714]

Function call stack:
distributed_function

2020-04-06 13:51:33.452168: W tensorflow/core/kernels/data/generator_dataset_op.cc:102] Error occurred when finalizing GeneratorDataset iterator: Failed precondition: Python interpreter state is not initialized. The process may be terminated.
	 [[{{node PyFunc}}]]
k = 5
configuration 1/1	 model name: nc_tcn_grid_k_5_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 13:52:11.098342: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 13:52:11.113872: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 13:52:11.114589: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cd361c2f40 executing computations on platform Host. Devices:
2020-04-06 13:52:11.114609: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 13:52:11.127110: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 603,717
Trainable params: 603,717
Non-trainable params: 0
_________________________________________________________________
2020-04-06 13:52:27.388622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 13:52:37.922457: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 13:52:48.446108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 13:52:58.975012: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 13:53:09.481626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 13:53:20.001940: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 13:53:27.014734: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 13:53:37.543933: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 13:53:48.026609: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 13:53:58.548343: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 13:54:09.045511: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 13:54:19.602702: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 13:54:30.129290: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 13:54:35.698158: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 13:54:59.932126: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 13:55:10.442558: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 13:55:20.998121: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 13:55:31.565625: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 13:55:42.093399: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 13:55:49.172882: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 13:56:00.735224: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 13:56:11.267384: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 13:56:21.766655: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 13:56:32.300101: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 13:56:39.303895: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 13:56:49.848061: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 13:57:00.420694: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 13:57:09.891119: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
2020-04-06 13:57:09.891976: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Invalid argument: indices[384,0] = 193 is not in [0, 65)
	 [[{{node model/embedding/embedding_lookup}}]]
 1/40 [..............................] - ETA: 1:35:23WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
2020-04-06 13:57:10,004 - [WARNING] Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
Traceback (most recent call last):
  File "utils/test_model.py", line 231, in <module>
    tensorboard=(not args.no_tensorboard), callbacks=callbacks)
  File "/home/lo63tor/master/dna_class/models/model.py", line 353, in train
    epochs=epochs, callbacks=callbacks)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 728, in fit
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 324, in fit
    total_epochs=epochs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 123, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py", line 86, in execution_function
    distributed_function(input_fn))
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 457, in __call__
    result = self._call(*args, **kwds)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 520, in _call
    return self._stateless_fn(*args, **kwds)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1823, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1141, in _filtered_call
    self.captured_inputs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1224, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 511, in call
    ctx=ctx)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py", line 67, in quick_execute
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError:  indices[384,0] = 193 is not in [0, 65)
	 [[node model/embedding/embedding_lookup (defined at /home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:1751) ]] [Op:__inference_distributed_function_7714]

Function call stack:
distributed_function

2020-04-06 13:57:10.172162: W tensorflow/core/kernels/data/generator_dataset_op.cc:102] Error occurred when finalizing GeneratorDataset iterator: Failed precondition: Python interpreter state is not initialized. The process may be terminated.
	 [[{{node PyFunc}}]]
k = 6
configuration 1/1	 model name: nc_tcn_grid_k_6_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 13:57:26.756063: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 13:57:26.763932: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 13:57:26.764560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563854c49650 executing computations on platform Host. Devices:
2020-04-06 13:57:26.764576: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 13:57:26.771031: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65        
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 603,717
Trainable params: 603,717
Non-trainable params: 0
_________________________________________________________________
2020-04-06 13:57:45.082889: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 13:57:53.220232: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 13:58:05.191394: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 13:58:13.171490: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 13:58:25.155915: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 13:58:33.130658: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 13:58:45.147552: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 13:58:53.128115: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 13:59:05.259594: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 13:59:13.239155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 13:59:25.217276: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 13:59:33.225962: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 13:59:45.179097: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 13:59:53.162534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 14:00:05.851172: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 14:00:12.174542: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 14:00:38.393919: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 14:00:46.447347: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 14:00:58.537001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 14:01:06.522729: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 14:01:18.509980: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 14:01:26.440166: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 14:01:38.513002: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 14:01:46.555562: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 14:01:58.561706: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 14:02:06.544092: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 14:02:18.590993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 14:02:26.542304: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 14:02:38.304586: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 14:02:46.324233: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 14:02:58.358549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 14:03:04.731753: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
2020-04-06 14:03:04.732521: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Invalid argument: indices[576,0] = 3358 is not in [0, 65)
	 [[{{node model/embedding/embedding_lookup}}]]
 1/40 [..............................] - ETA: 1:46:44WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
2020-04-06 14:03:04,807 - [WARNING] Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
Traceback (most recent call last):
  File "utils/test_model.py", line 231, in <module>
    tensorboard=(not args.no_tensorboard), callbacks=callbacks)
  File "/home/lo63tor/master/dna_class/models/model.py", line 353, in train
    epochs=epochs, callbacks=callbacks)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py", line 728, in fit
    use_multiprocessing=use_multiprocessing)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 324, in fit
    total_epochs=epochs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py", line 123, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py", line 86, in execution_function
    distributed_function(input_fn))
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 457, in __call__
    result = self._call(*args, **kwds)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py", line 520, in _call
    return self._stateless_fn(*args, **kwds)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1823, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1141, in _filtered_call
    self.captured_inputs)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1224, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 511, in call
    ctx=ctx)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py", line 67, in quick_execute
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError:  indices[576,0] = 3358 is not in [0, 65)
	 [[node model/embedding/embedding_lookup (defined at /home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:1751) ]] [Op:__inference_distributed_function_7714]

Function call stack:
distributed_function

2020-04-06 14:03:04.961197: W tensorflow/core/kernels/data/generator_dataset_op.cc:102] Error occurred when finalizing GeneratorDataset iterator: Failed precondition: Python interpreter state is not initialized. The process may be terminated.
	 [[{{node PyFunc}}]]
k = 7
  C-c C-cTraceback (most recent call last):
  File "utils/test_model.py", line 4, in <module>
    import tensorflow as tf
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow/__init__.py", line 98, in <module>
    from tensorflow_core import *
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/__init__.py", line 40, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 959, in _find_and_load_unlocked
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow/__init__.py", line 50, in __getattr__
    module = self._load()
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow/__init__.py", line 44, in _load
    module = _importlib.import_module(self.__name__)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/__init__.py", line 83, in <module>
    from tensorflow.python import keras
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/__init__.py", line 26, in <module>
    from tensorflow.python.keras import activations
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/__init__.py", line 26, in <module>
    from tensorflow.python.keras import activations
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/activations.py", line 23, in <module>
    from tensorflow.python.keras.utils.generic_utils import deserialize_keras_object
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/utils/__init__.py", line 38, in <module>
    from tensorflow.python.keras.utils.multi_gpu_utils import multi_gpu_model
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/utils/multi_gpu_utils.py", line 22, in <module>
    from tensorflow.python.keras.engine.training import Model
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/__init__.py", line 24, in <module>
    from tensorflow.python.keras.engine.input_layer import Input
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/input_layer.py", line 25, in <module>
    from tensorflow.python.keras.distribute import distributed_training_utils
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/distribute/distributed_training_utils.py", line 38, in <module>
    from tensorflow.python.keras import callbacks
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/python/keras/callbacks.py", line 53, in <module>
    import requests
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 963, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 906, in _find_spec
  File "<frozen importlib._bootstrap_external>", line 1280, in find_spec
  File "<frozen importlib._bootstrap_external>", line 1252, in _get_spec
  File "<frozen importlib._bootstrap_external>", line 1364, in find_spec
  File "<frozen importlib._bootstrap_external>", line 81, in _path_stat
KeyboardInterrupt

(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$   -h, --help            show this help message and exit
-h,: command not found
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ for k in 4 5 6 7 8; do echo k = $k; nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn_grid_k_"$k" --nr_seqs 10_000 --batch_size 768 --summary --epochs 5 --nr_filters 72 --kernel_size 6 --enc_stride 1 --enc_k $k --cache_batches False --enc_dimension $(python -c "print(4**$k)"); done
k = 4
  C-c C-cTraceback (most recent call last):
  File "utils/test_model.py", line 4, in <module>
    import tensorflow as tf
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow/__init__.py", line 98, in <module>
    from tensorflow_core import *
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/__init__.py", line 45, in <module>
    from . _api.v2 import compat
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/_api/v2/compat/__init__.py", line 23, in <module>
    from . import v1
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_core/_api/v2/compat/v1/__init__.py", line 664, in <module>
    from tensorflow_estimator.python.estimator.api._v1 import estimator
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_estimator/__init__.py", line 10, in <module>
    from tensorflow_estimator._api.v1 import estimator
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_estimator/_api/v1/estimator/__init__.py", line 12, in <module>
    from tensorflow_estimator._api.v1.estimator import inputs
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_estimator/_api/v1/estimator/inputs/__init__.py", line 10, in <module>
    from tensorflow_estimator.python.estimator.inputs.numpy_io import numpy_input_fn
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/inputs/numpy_io.py", line 26, in <module>
    from tensorflow_estimator.python.estimator.inputs.queues import feeding_functions
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/inputs/queues/feeding_functions.py", line 40, in <module>
    import pandas as pd
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/pandas/__init__.py", line 30, in <module>
    from pandas._libs import hashtable as _hashtable, lib as _lib, tslib as _tslib
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/pandas/_libs/__init__.py", line 3, in <module>
    from .tslibs import (
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/pandas/_libs/tslibs/__init__.py", line 3, in <module>
    from .conversion import localize_pydatetime, normalize_date
  File "pandas/_libs/tslibs/c_timestamp.pxd", line 7, in init pandas._libs.tslibs.conversion
  File "pandas/_libs/tslibs/c_timestamp.pyx", line 1, in init pandas._libs.tslibs.c_timestamp
  File "pandas/_libs/tslibs/tzconversion.pyx", line 1, in init pandas._libs.tslibs.tzconversion
  File "pandas/_libs/tslibs/timedeltas.pyx", line 1, in init pandas._libs.tslibs.timedeltas
  File "pandas/_libs/tslibs/offsets.pyx", line 1, in init pandas._libs.tslibs.offsets
  File "pandas/_libs/tslibs/ccalendar.pyx", line 13, in init pandas._libs.tslibs.ccalendar
  File "pandas/_libs/tslibs/strptime.pyx", line 615, in init pandas._libs.tslibs.strptime
  File "pandas/_libs/tslibs/strptime.pyx", line 558, in pandas._libs.tslibs.strptime.TimeRE.__init__
  File "pandas/_libs/tslibs/strptime.pyx", line 574, in pandas._libs.tslibs.strptime.TimeRE.__seqToRE
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/pytz/lazy.py", line 101, in _lazy
    list.extend(self, fill_iter.pop())
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/pytz/__init__.py", line 1104, in <genexpr>
    tz for tz in all_timezones if resource_exists(tz))
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/pytz/__init__.py", line 114, in resource_exists
    open_resource(name).close()
  File "/home/lo63tor/miniconda3/envs/dna_class_gpu/lib/python3.7/site-packages/pytz/__init__.py", line 108, in open_resource
    return open(filename, 'rb')
KeyboardInterrupt

(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ for k in 4 5 6 7 8; do echo k = $k; nice python utils/test_model.py tcn --fixed_size_method window --enc_method words2index --data_source fragments --max_seq_len 250 --model_name nc_tcn_grid_k_"$k" --nr_seqs 10_000 --batch_size 768 --summary --epochs 5 --nr_filters 72 --kernel_size 6 --enc_stride 1 --enc_k $k --cache_batches False --enc_dimension $(python -c "print(4**$k + 1)"); done
k = 4
configuration 1/1	 model name: nc_tcn_grid_k_4_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 14:06:37.504162: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 14:06:37.511394: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 14:06:37.511920: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564f2a9c1170 executing computations on platform Host. Devices:
2020-04-06 14:06:37.511935: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 14:06:37.518958: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            257       
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 603,909
Trainable params: 603,909
Non-trainable params: 0
_________________________________________________________________
2020-04-06 14:06:54.161595: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 14:07:03.260687: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 14:07:12.355117: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 14:07:24.533661: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 14:07:34.111293: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 14:07:43.993931: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 14:07:53.389620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 14:08:02.486313: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 14:08:14.822421: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 14:08:23.928112: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 14:08:33.048479: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 14:08:42.110337: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 14:08:43.891604: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 14:09:08.451673: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 14:09:17.548127: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 14:09:26.918526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 14:09:39.079306: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 14:09:48.194993: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 14:09:57.319952: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 14:10:06.451115: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 14:10:18.606096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 14:10:27.884622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 14:10:36.982142: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 14:10:49.037510: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 14:10:57.049742: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 697s 17s/step - loss: 1.4579 - accuracy: 0.3110 - val_loss: 1.2303 - val_accuracy: 0.4087
Epoch 2/5
2020-04-06 14:20:40.595471: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 14:20:50.513913: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 14:20:59.637459: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 14:21:09.100116: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 14:21:18.567758: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 14:21:27.747990: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 19 of 40
2020-04-06 14:21:39.950457: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 14:21:49.092560: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 14:21:58.242958: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 14:22:10.427061: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 14:22:19.543750: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 14:22:28.652376: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 14:22:30.422782: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 689s 17s/step - loss: 1.1958 - accuracy: 0.4184 - val_loss: 1.1200 - val_accuracy: 0.4519
Epoch 3/5
2020-04-06 14:32:08.374333: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 14:32:17.506735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 14:32:26.628164: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 14:32:38.808865: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 14:32:47.944512: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 14:32:57.184443: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 14:33:06.272444: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 14:33:18.403353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 14:33:27.522014: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 14:33:36.616159: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 14:33:48.778762: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 14:33:56.864037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 689s 17s/step - loss: 1.1594 - accuracy: 0.4404 - val_loss: 1.1493 - val_accuracy: 0.4519
Epoch 4/5
2020-04-06 14:43:37.621960: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 14:43:47.059166: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 14:43:56.159101: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 14:44:08.315913: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 14:44:17.395109: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 14:44:26.589468: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 14:44:35.681748: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 14:44:47.884464: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 14:44:56.987568: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 14:45:06.090491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 14:45:18.244274: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 14:45:26.096988: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 699s 17s/step - loss: 1.1527 - accuracy: 0.4443 - val_loss: 1.1211 - val_accuracy: 0.4512
Epoch 5/5
2020-04-06 14:55:17.553154: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 14:55:26.732891: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 14:55:35.893978: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 14:55:45.110438: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 14:55:57.361214: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 14:56:06.574886: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 14:56:15.754506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 14:56:24.936073: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 14:56:37.207598: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 14:56:46.386114: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 14:56:55.569835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 14:57:04.887483: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 14:57:06.665166: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 686s 17s/step - loss: 1.1461 - accuracy: 0.4456 - val_loss: 1.1489 - val_accuracy: 0.4644
test loss / test accuracy = 1.1675 / 0.4436
              precision    recall  f1-score   support

     Viruses       0.37      0.67      0.48      1976
     Archaea       0.41      0.43      0.42      1981
    Bacteria       0.65      0.45      0.53      2020
   Eukaryota       0.50      0.25      0.33      2023

    accuracy                           0.45      8000
   macro avg       0.48      0.45      0.44      8000
weighted avg       0.49      0.45      0.44      8000

k = 5
configuration 1/1	 model name: nc_tcn_grid_k_5_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 15:10:05.342277: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 15:10:05.356992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 15:10:05.357708: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5589bfb1b180 executing computations on platform Host. Devices:
2020-04-06 15:10:05.357729: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 15:10:05.367110: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            1025      
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 604,677
Trainable params: 604,677
Non-trainable params: 0
_________________________________________________________________
2020-04-06 15:10:21.283964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 15:10:32.496841: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 15:10:42.988537: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 15:10:53.526315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 15:11:04.026195: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 15:11:11.015112: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 15:11:21.521190: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 15:11:32.045946: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 15:11:42.557506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 15:11:53.134247: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 15:12:03.603678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 15:12:14.116192: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 15:12:21.726721: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 15:12:30.815913: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 15:12:55.380921: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 15:13:06.271297: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 15:13:16.951061: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 15:13:24.529706: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 15:13:35.485640: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 15:13:46.061799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 15:13:56.652930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 15:14:07.235747: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 15:14:14.293742: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 15:14:24.876783: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 15:14:35.430799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 15:14:45.989596: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 15:14:56.561620: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 15:15:05.651897: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 722s 18s/step - loss: 1.5060 - accuracy: 0.2810 - val_loss: 1.2793 - val_accuracy: 0.3844
Epoch 2/5
2020-04-06 15:24:51.464695: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 15:25:02.042899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 15:25:12.612012: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 15:25:23.209018: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 15:25:33.765105: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 15:25:44.354718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 15:25:51.430885: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 15:26:02.020125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 15:26:12.573807: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 15:26:23.171572: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 15:26:33.779346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 15:26:40.858315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 15:26:51.460570: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 15:27:00.610584: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 707s 18s/step - loss: 1.1995 - accuracy: 0.4161 - val_loss: 1.1624 - val_accuracy: 0.4319
Epoch 3/5
2020-04-06 15:36:38.727079: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 15:36:49.764471: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 15:37:00.336001: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 15:37:10.893579: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 15:37:17.912303: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 15:37:28.476555: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 15:37:39.006567: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 15:37:49.550155: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 15:38:00.075493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 15:38:10.659713: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 15:38:17.690817: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 15:38:28.258037: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 15:38:38.812678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 15:38:47.899438: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 709s 18s/step - loss: 1.1562 - accuracy: 0.4447 - val_loss: 1.2062 - val_accuracy: 0.4219
Epoch 4/5
2020-04-06 15:48:27.193684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 15:48:37.980231: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 15:48:48.626552: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 15:48:59.232459: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 15:49:06.290692: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 15:49:16.746759: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 15:49:27.358020: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 15:49:37.957287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 15:49:48.534477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 15:49:59.145069: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 15:50:06.211506: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 15:50:16.954850: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 15:50:27.701936: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 15:50:36.871535: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 710s 18s/step - loss: 1.1417 - accuracy: 0.4507 - val_loss: 1.1269 - val_accuracy: 0.4363
Epoch 5/5
2020-04-06 16:00:16.667559: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 16:00:27.283765: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 16:00:37.889285: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 16:00:48.734663: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 16:00:59.537979: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 16:01:07.465478: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 16:01:18.690984: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 16:01:26.207959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 16:01:37.398435: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 16:01:48.997390: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 16:01:56.430728: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 16:02:07.013762: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 16:02:17.647426: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 16:02:28.269104: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 16:02:30.333401: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 710s 18s/step - loss: 1.1265 - accuracy: 0.4600 - val_loss: 1.1694 - val_accuracy: 0.4275
test loss / test accuracy = 1.1591 / 0.4416
              precision    recall  f1-score   support

     Viruses       0.33      0.24      0.28      2008
     Archaea       0.43      0.51      0.47      2072
    Bacteria       0.67      0.39      0.49      1993
   Eukaryota       0.43      0.64      0.51      1927

    accuracy                           0.44      8000
   macro avg       0.46      0.45      0.44      8000
weighted avg       0.46      0.44      0.44      8000

k = 6
configuration 1/1	 model name: nc_tcn_grid_k_6_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 16:15:37.870146: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 16:15:37.884740: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 16:15:37.885475: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d302533a50 executing computations on platform Host. Devices:
2020-04-06 16:15:37.885498: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 16:15:37.899135: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            4097      
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 607,749
Trainable params: 607,749
Non-trainable params: 0
_________________________________________________________________
2020-04-06 16:15:55.676753: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 16:16:03.689784: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 16:16:15.647305: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 16:16:23.631287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 16:16:35.590353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 16:16:43.549564: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 16:16:55.479287: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 16:17:03.944205: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 16:17:16.845676: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 16:17:25.381105: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 16:17:37.369012: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 16:17:45.353415: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 16:17:57.333909: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 16:18:05.318186: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 16:18:17.323408: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 16:18:23.659862: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 16:18:50.092161: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 16:18:58.133461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 16:19:10.182447: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 16:19:18.226487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 16:19:30.244861: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 16:19:38.286340: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 16:19:50.380211: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 16:19:58.606491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 16:20:10.890592: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 16:20:18.956999: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 16:20:31.153601: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 16:20:39.243704: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 16:20:51.376860: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 16:20:59.610074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 16:21:07.947135: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 16:21:18.391930: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 742s 19s/step - loss: 1.5105 - accuracy: 0.2863 - val_loss: 1.2501 - val_accuracy: 0.3781
Epoch 2/5
2020-04-06 16:31:06.082690: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 16:31:14.115257: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 16:31:26.113129: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 16:31:34.093890: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 16:31:46.446684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 16:31:54.715425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 16:32:06.729592: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 16:32:14.757853: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 16:32:27.841474: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 16:32:36.557727: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 16:32:44.798486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 16:32:57.365074: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 16:33:05.580612: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 16:33:17.683964: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 16:33:25.750631: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 16:33:36.171295: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 731s 18s/step - loss: 1.2118 - accuracy: 0.4093 - val_loss: 1.1657 - val_accuracy: 0.4425
Epoch 3/5
2020-04-06 16:43:17.437605: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 16:43:25.484899: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 16:43:37.487887: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 16:43:45.548405: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 16:43:58.047799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 16:44:06.096693: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 16:44:18.174051: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 16:44:26.253827: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 16:44:38.304813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 16:44:46.374597: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 16:44:58.514917: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 16:45:06.559176: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 16:45:14.713688: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 16:45:26.864865: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 16:45:35.309045: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 16:45:45.794177: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 734s 18s/step - loss: 1.1391 - accuracy: 0.4530 - val_loss: 1.1127 - val_accuracy: 0.4669
Epoch 4/5
2020-04-06 16:55:31.253534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 16:55:39.672761: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 16:55:51.782622: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 16:55:59.842065: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 16:56:12.705741: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 16:56:21.241781: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 16:56:29.300634: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 16:56:41.415520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 16:56:49.446726: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 16:57:01.540626: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 16:57:09.621047: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 16:57:19.018372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 16:57:31.126553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 16:57:39.192451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 16:57:51.316954: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 16:57:59.367159: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 16:58:01.729607: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 732s 18s/step - loss: 1.1106 - accuracy: 0.4755 - val_loss: 1.1030 - val_accuracy: 0.4881
Epoch 5/5
2020-04-06 17:07:43.674587: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 17:07:51.923532: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 17:08:04.122372: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 17:08:12.151354: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 17:08:24.202775: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 17:08:32.205618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 17:08:44.228116: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 17:08:52.280634: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 17:09:04.329678: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 17:09:12.376332: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 17:09:24.472703: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 17:09:32.515252: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 17:09:44.606132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 17:09:52.668906: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 17:10:04.738086: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 17:10:11.104610: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 729s 18s/step - loss: 1.0807 - accuracy: 0.5004 - val_loss: 1.1124 - val_accuracy: 0.5013
test loss / test accuracy = 1.0755 / 0.5101
              precision    recall  f1-score   support

     Viruses       0.45      0.59      0.51      1994
     Archaea       0.43      0.39      0.41      1981
    Bacteria       0.57      0.68      0.62      2053
   Eukaryota       0.66      0.37      0.47      1972

    accuracy                           0.51      8000
   macro avg       0.53      0.51      0.50      8000
weighted avg       0.53      0.51      0.50      8000

k = 7
configuration 1/1	 model name: nc_tcn_grid_k_7_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 17:23:50.389106: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 17:23:50.402562: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 17:23:50.403474: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c62234f160 executing computations on platform Host. Devices:
2020-04-06 17:23:50.403523: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 17:23:50.410996: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            16385     
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 620,037
Trainable params: 620,037
Non-trainable params: 0
_________________________________________________________________
2020-04-06 17:24:10.712731: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 17:24:19.804604: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 17:24:28.912023: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 17:24:38.025813: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 17:24:47.137452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 17:25:00.810908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 17:25:09.868657: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 17:25:18.966179: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 17:25:28.098462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 17:25:37.202110: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 17:25:50.851361: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 17:25:59.978029: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 17:26:09.165952: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 17:26:18.290974: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 17:26:27.412328: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 17:26:41.085718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 17:26:50.203961: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 17:26:57.432684: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 17:27:26.282413: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 17:27:35.351451: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 17:27:44.486394: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 17:27:53.619010: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 17:28:02.731988: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 17:28:16.478362: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 17:28:25.657992: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 17:28:34.796793: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 17:28:43.994379: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 17:28:53.188379: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 17:29:06.950478: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 17:29:16.150278: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 17:29:25.296440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 17:29:34.520940: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 17:29:43.687324: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 17:29:52.836616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 17:30:06.604194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 17:30:13.870520: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 758s 19s/step - loss: 1.5300 - accuracy: 0.2515 - val_loss: 1.3827 - val_accuracy: 0.2663
Epoch 2/5
2020-04-06 17:39:59.145696: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 17:40:08.333107: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 17:40:17.430368: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 17:40:26.579749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 17:40:35.695911: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 17:40:49.984182: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 17:40:55.256108: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 17:41:08.990275: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 17:41:18.179111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 17:41:27.347202: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 17:41:36.539289: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 17:41:45.712349: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 17:41:59.496210: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 17:42:08.705743: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 17:42:17.883312: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 17:42:27.045410: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 17:42:36.218125: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 17:42:45.389925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 17:42:48.070481: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 742s 19s/step - loss: 1.3249 - accuracy: 0.3367 - val_loss: 1.2097 - val_accuracy: 0.4144
Epoch 3/5
2020-04-06 17:52:21.321440: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 17:52:30.441482: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 17:52:39.552820: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 17:52:48.717449: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 17:52:57.853605: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 17:53:11.576187: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 17:53:20.753310: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 17:53:29.935371: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 17:53:39.146757: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 17:53:48.344735: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 17:53:57.522015: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 17:54:11.291432: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 17:54:20.499815: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 17:54:29.723512: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 17:54:38.973194: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 17:54:48.200477: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 17:55:01.996811: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 17:55:09.292581: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 732s 18s/step - loss: 1.2348 - accuracy: 0.4002 - val_loss: 1.1404 - val_accuracy: 0.4169
Epoch 4/5
2020-04-06 18:04:33.629304: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 3 of 40
2020-04-06 18:04:42.739521: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 18:04:51.891486: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 18:05:02.846240: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 18:05:12.032268: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 18:05:22.079838: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 18:05:31.261736: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 18:05:40.417505: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 18:05:54.119640: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 18:06:03.288703: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 18:06:12.416157: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 18:06:21.538526: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 18:06:30.649534: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 18:06:44.323346: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 18:06:53.449025: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 18:07:03.115616: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 18:07:12.266982: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 18:07:21.395138: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 18:07:24.046835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 754s 19s/step - loss: 1.1606 - accuracy: 0.4415 - val_loss: 1.1201 - val_accuracy: 0.4650
Epoch 5/5
2020-04-06 18:17:04.080656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 2 of 40
2020-04-06 18:17:18.094747: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 5 of 40
2020-04-06 18:17:27.167079: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 7 of 40
2020-04-06 18:17:36.340714: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 9 of 40
2020-04-06 18:17:45.511866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 18:17:54.691908: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 18:18:08.496018: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 18:18:17.640466: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 18:18:26.821209: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 18:18:36.025430: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 18:18:45.176742: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 18:18:54.334866: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 18:19:08.094071: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 18:19:17.280315: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 18:19:26.416221: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 18:19:35.566378: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 18:19:44.739151: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 18:19:54.244587: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 18:19:57.089329: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 759s 19s/step - loss: 1.1461 - accuracy: 0.4472 - val_loss: 1.0935 - val_accuracy: 0.4881
test loss / test accuracy = 1.1320 / 0.4448
              precision    recall  f1-score   support

     Viruses       0.39      0.42      0.41      2030
     Archaea       0.36      0.34      0.35      1980
    Bacteria       0.51      0.63      0.57      1999
   Eukaryota       0.53      0.39      0.45      1991

    accuracy                           0.45      8000
   macro avg       0.45      0.45      0.44      8000
weighted avg       0.45      0.45      0.44      8000

k = 8
configuration 1/1	 model name: nc_tcn_grid_k_8_845882975, settings: {'emb_layer_dim': 1, 'dropout_rate': 0.01, 'kernel_size': 6, 'nb_filters': 72, 'dilations': [1, 2, 4, 8, 16, 32, 64, 128, 256]}
2020-04-06 18:33:52.604849: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-04-06 18:33:52.618543: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3497985000 Hz
2020-04-06 18:33:52.619409: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562293b9f790 executing computations on platform Host. Devices:
2020-04-06 18:33:52.619443: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-06 18:33:52.627118: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input (InputLayer)           [(None, 250)]             0         
_________________________________________________________________
embedding (Embedding)        (None, 250, 1)            65537     
_________________________________________________________________
tcn (TCN)                    (None, 72)                603360    
_________________________________________________________________
classification (Dense)       (None, 4)                 292       
=================================================================
Total params: 669,189
Trainable params: 669,189
Non-trainable params: 0
_________________________________________________________________
2020-04-06 18:34:09.809234: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 2 of 40
2020-04-06 18:34:19.951493: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 18:34:30.059302: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 18:34:40.401556: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 18:34:50.527844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 18:35:00.617084: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 18:35:10.776749: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 18:35:20.892474: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 18:35:31.022430: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 18:35:41.109163: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 18:35:51.218488: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 18:36:01.315580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 18:36:11.443134: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 18:36:21.554384: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 18:36:31.695726: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 18:36:41.984414: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 18:36:52.116331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 18:37:02.233858: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 18:37:12.418021: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 18:37:20.439925: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
Train for 40 steps, validate for 3 steps
Epoch 1/5
2020-04-06 18:37:47.027140: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 2 of 40
2020-04-06 18:37:57.177487: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 18:38:07.345656: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 18:38:17.519207: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 18:38:27.698588: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 18:38:37.845941: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 18:38:48.058893: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 18:38:58.249833: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 18:39:08.433895: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 18:39:18.641058: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 18:39:28.820507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 18:39:39.041704: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 18:39:49.265529: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 18:39:59.492830: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 18:40:09.882348: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 18:40:20.159802: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 18:40:30.412273: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 18:40:40.700681: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 18:40:50.952485: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 18:40:59.565663: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 784s 20s/step - loss: 1.6645 - accuracy: 0.2598 - val_loss: 1.4209 - val_accuracy: 0.2406
Epoch 2/5
2020-04-06 18:50:45.133143: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 2 of 40
2020-04-06 18:50:55.349154: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 18:51:05.523448: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 18:51:16.299819: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 18:51:26.484331: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 18:51:36.653726: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 18:51:46.871944: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 18:51:57.109461: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 18:52:07.307065: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 18:52:17.491248: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 18:52:27.736141: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 18:52:37.972901: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 18:52:48.193969: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 26 of 40
2020-04-06 18:52:58.425228: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 28 of 40
2020-04-06 18:53:08.626353: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 30 of 40
2020-04-06 18:53:18.887760: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 32 of 40
2020-04-06 18:53:29.118973: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 34 of 40
2020-04-06 18:53:39.334961: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 36 of 40
2020-04-06 18:53:49.550105: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 38 of 40
2020-04-06 18:53:57.670694: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 775s 19s/step - loss: 1.3607 - accuracy: 0.3053 - val_loss: 1.2997 - val_accuracy: 0.3594
Epoch 3/5
2020-04-06 19:03:40.746799: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 2 of 40
2020-04-06 19:03:51.131064: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 19:04:01.513652: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 19:04:12.113075: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 19:04:22.350788: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 19:04:32.812213: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 19:04:43.098718: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 19:04:53.285170: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 19:05:03.464462: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 19:05:13.943808: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 19:05:24.421147: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 19:05:34.589326: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 24 of 40
2020-04-06 19:05:39.701111: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 19:05:50.840617: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 19:06:01.367344: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 19:06:11.572308: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 19:06:22.040020: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 19:06:32.268380: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 19:06:42.452071: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 19:06:52.704580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 19:06:55.682787: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 776s 19s/step - loss: 1.2300 - accuracy: 0.4125 - val_loss: 1.1767 - val_accuracy: 0.4369
Epoch 4/5
2020-04-06 19:16:36.464738: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 2 of 40
2020-04-06 19:16:46.720628: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 19:16:56.923038: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 19:17:07.157972: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 19:17:17.376452: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 19:17:27.599459: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 12 of 40
2020-04-06 19:17:37.811002: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 14 of 40
2020-04-06 19:17:48.075715: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 16 of 40
2020-04-06 19:17:58.623463: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 18 of 40
2020-04-06 19:18:09.794239: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 20 of 40
2020-04-06 19:18:20.840296: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 22 of 40
2020-04-06 19:18:26.358123: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 19:18:36.817098: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 19:18:47.071400: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 19:18:57.324508: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 19:19:07.597741: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 19:19:17.879844: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 19:19:28.132561: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 19:19:38.816076: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 19:19:49.075790: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 19:19:52.051152: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 782s 20s/step - loss: 1.1521 - accuracy: 0.4513 - val_loss: 1.1465 - val_accuracy: 0.4481
Epoch 5/5
2020-04-06 19:29:39.349016: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 2 of 40
2020-04-06 19:29:50.335458: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4 of 40
2020-04-06 19:30:01.363627: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 6 of 40
2020-04-06 19:30:12.440065: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 8 of 40
2020-04-06 19:30:23.540815: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 10 of 40
2020-04-06 19:30:28.634924: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 11 of 40
2020-04-06 19:30:38.789179: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 13 of 40
2020-04-06 19:30:49.755588: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 15 of 40
2020-04-06 19:30:59.946739: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 17 of 40
2020-04-06 19:31:10.565465: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 19 of 40
2020-04-06 19:31:20.811507: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 21 of 40
2020-04-06 19:31:31.104671: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 23 of 40
2020-04-06 19:31:41.315959: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 25 of 40
2020-04-06 19:31:51.492425: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 27 of 40
2020-04-06 19:32:01.702243: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 29 of 40
2020-04-06 19:32:11.887165: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 31 of 40
2020-04-06 19:32:22.061443: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 33 of 40
2020-04-06 19:32:32.303476: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 35 of 40
2020-04-06 19:32:42.513738: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 37 of 40
2020-04-06 19:32:52.753310: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 39 of 40
2020-04-06 19:32:55.742192: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
40/40 [==============================] - 779s 19s/step - loss: 1.1063 - accuracy: 0.4839 - val_loss: 1.1184 - val_accuracy: 0.4650
test loss / test accuracy = 1.1298 / 0.4714
              precision    recall  f1-score   support

     Viruses       0.41      0.54      0.46      1958
     Archaea       0.39      0.48      0.43      2030
    Bacteria       0.57      0.52      0.54      2002
   Eukaryota       0.65      0.35      0.46      2010

    accuracy                           0.47      8000
   macro avg       0.50      0.47      0.47      8000
weighted avg       0.50      0.47      0.47      8000

(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ ls
bacteria_mapping.txt			  misc				  test
bert_ft_test_4035121793.json		  models			  test1.fa
bert.py.lprof				  nc_tcn_658449957.json		  test2.fa
bert.py.prof				  nc_tcn_grid_k_3_845882975.json  test3.fa
bert_v0_trained_seq_vectors_10k.pkl	  nc_tcn_grid_k_4_845882975.json  test_all_species.txt
bert_v0_trained_seq_vectors_test.pkl	  nc_tcn_grid_k_5_845882975.json  test_bacteria_accessions.txt
bert_v1_epoch0.h5			  nc_tcn_grid_k_6_845882975.json  test_bacteria.fa
bert_v1_epoch1.h5			  nc_tcn_grid_k_7_845882975.json  test_bacteria_mapping.txt
bert_v1_trained.h5			  nc_tcn_grid_k_8_845882975.json  test_fragments.json
cnndeep_predef_rerun_3193320546.json	  output			  test_mapping.txt
dists.pkl				  preprocessing			  test_picked_species.txt
full_genome_bacteria.fna.idx		  __pycache__			  utils
GCF_006149115.1_Oner_1.0_genomic.fna.idx  README.org			  virus_gis.txt
__init__.py				  resources			  virus_mapping.txt
logs					  taxdump.tar.gz
(dna_class_gpu) lo63tor@zwoa:~/master/dna_class$ 
